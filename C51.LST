C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE C51
OBJECT MODULE PLACED IN C51.OBJ
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE C51.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include<reg52.h>        //Í·ÎÄ¼ş
   2          #include<intrins.h>
   3          #include"eeprom52.h"       //STC89C52 EEPROM   ³ÌĞòÎÄ¼ş
   4          #define uchar unsigned char    //ºê¶¨Òå
   5          #define uint unsigned int
   6          
   7          #define LCD1602_dat P0   //LCD1602Êı¾İ¿Úºê¶¨Òå
   8          
   9          
  10          sbit LCD1602_rs=P2^5;   //LCD1602¿ØÖÆÊı¾İIO¿Ú
  11          sbit LCD1602_rw=P2^6;
  12          sbit LCD1602_e=P2^7;
  13          sbit beep=P1^3;   //·äÃùÆ÷  IO
  14          sbit led_1=P1^4;    //LEDÖ¸Ê¾µÆ  IO
  15          sbit led_2=P1^6;
  16          sbit key_1=P3^2;    //ÏµÍ³¿ØÖÆ°´¼üIO¿Ú
  17          sbit key_2=P3^3;
  18          sbit key_3=P3^4;
  19          sbit alarm_1=P2^0;    //¿ØÖÆ¼ÌµçÆ÷IO¿Ú
  20          
  21          
  22          sbit ADC0832_CS=P1^2; //ADC0832  ¿ØÖÆIO¿Ú   Ê¹ÄÜ¿Ú
  23          sbit ADC0832_CLK=P1^1;  //Ê±ÖÓIO¿Ú
  24          sbit ADC0832_DIO=P1^0;  //Êı¾İÊäÈëÊä³öIO¿Ú 
  25          
  26          uint sum, waterCount;       //10´ÎADÖµµÄ×ÛºÏ±äÁ¿,Ë®Á¿Í³¼Æ
  27          uchar RH_H=12,RH_L=8,state,ms,cs,motorTimeCount,aimLevel;  //µ±Ç°Ë®Î»£¬  Ë®Î»ÉÏÏŞ£¬ÏÂÏŞ£¬  ÉèÖÃÏî±äÁ¿£¬50m
             -s±äÁ¿   £¬cs Îª¼Æ´ÎÊı±äÁ¿    ,µç»úÊ±¼ä¼ÆÁ¿,ÓÃË®ÉÏÏŞ
  28          bit beep1,s1,overLimit,pidFlag;   //±¨¾¯±êÖ¾Î»£¬ ÉÁË¸±êÖ¾Î» ,ÓÃË®¹ıÁ¿±êÖ¾£¬pidÔËĞĞ±êÖ¾
  29          
  30            static float ki = 0.3;//»ı·ÖÏµÊı
  31          
  32          int motorRunTime = -1;//ÈôÎª-1£¬²»¶¯×÷£¬´óÓÚ0£¬¿ªÆô¼¸Ãë
  33          
  34          uchar pidCount,pidTime;
  35          
  36          uchar zt;//Ä£Ê½±êÖ¾
  37          float motorKP;//±ÈÀıÏµÊı
  38          float RH;//µ±Ç°Ë®Î»
  39          float Ad_dat,Ad_datN;
  40           
  41          
  42          /*
  43              ADC0832ÊÇÒ»¿î8Î»AdĞ¾Æ¬£¬ÒòÎªµ¥Æ¬»ú²»ÄÜÖ±½Ó´¦ÀíÄ£ÄâĞÅºÅ£¨µçÑ¹£©£¬ËùÒÔµ¥Æ¬»ú²âµçÑ¹µÄÊ±ºò»ù±¾¶¼ÊÇÏÈ¾­¹ıÒ»
             -¸öÄ£Êı×ª»»Ğ¾Æ¬£¬½«Ä£ÄâÁ¿
  44          ×ª»¯³ÉÊı×ÖÁ¿£¬È»ºó´¦Àí£¬ADC0832²âÁ¿µÄµçÑ¹·¶Î§ÊÇ0-5V£¬ËüÄÜ¹»½«0¡ª5VµÄµçÑ¹×ª»¯³É¶ÔÓ¦±ÈÀı¹ØÏµµÄ0-255£¨8Î»ÊÇ0-
             -255£©µÄÊı¾İ£¬µ¥Æ¬»úÖ±
  45          ½Ó¶ÁÈ¡ADC0832µÄÊı¾İ»ñÈ¡ADÖµÊı¾İ£¬È»ºóÒòÎª0-5V¶ÔÓ¦0-255Êı¾İ£¬ËùÒÔ1Vµç¶ÔÓ¦µÄADÖµ¾ÍÊÇ51£¬¾Í»áÓĞÈçÏÂ¹«Ê½
  46          
  47            µçÑ¹=ADÖµ/51£»
  48          
  49          Èç¹ûÏë°ÑµçÑ¹Êı¾İ¾«È·µ½Ğ¡ÊıµãºóÒ»Î»¾ÍÊÇ   µçÑ¹=ADÖµ/5.1£»
  50                      Ğ¡ÊıµãºóÁ½Î»¾ÍÊÇ   µçÑ¹=ADÖµ/0.51£»
  51          
  52          ²»ÒªÎÊÎÒÎªÊ²Ã´£¬´¿ÊıÑ§£¬Ğ¡Ñ§Éú¶¼»áËã¡£
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 2   

  53           
  54          */
  55          /********************************************************************
  56          * Ãû³Æ : delay()
  57          * ¹¦ÄÜ : Ğ¡ÑÓÊ±¡£                          
  58          * ÊäÈë : ÎŞ
  59          * Êä³ö : ÎŞ
  60          ***********************************************************************/
  61          
  62          
  63          
  64          
  65          void delay(uint T)            //ÑÓÊ±º¯Êı
  66          {
  67   1        while(T--);
  68   1      }
  69          void saveWaterCount()
  70          {
  71   1        SectorErase(0x2400);   //±£´æÉÏÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
  72   1        byte_write(0x2400,waterCount);
  73   1      }
  74          
  75          void openMotorTime(uchar time)//¿ªÆôµç»útimeÃë
  76          {
  77   1        motorRunTime = time;
  78   1      }
  79          
  80          uint motorControl(uchar flag)//¿ª=1£¬¹Ø=0£¬ÇĞ»»=2,Ê²Ã´¶¼²»×ö²¢ÇÒ»ñÈ¡µ±Ç°×´Ì¬=3
  81          {
  82   1        bit a;
  83   1        if(flag == 0)//¹Ø
  84   1        {
  85   2          alarm_1 = 1;
  86   2          saveWaterCount();
  87   2        }
  88   1        else if(flag == 1&&alarm_1 == 1)//¿ª
  89   1        {
  90   2          alarm_1 = 0;
  91   2        }
  92   1        else if(flag == 2)
  93   1        {
  94   2          alarm_1 = !alarm_1;
  95   2        //  if(alarm_1 == 1)
  96   2          //  saveWaterCount();
  97   2        }
  98   1        else if(flag == 3)
  99   1        {
 100   2          return !alarm_1;
 101   2        }
 102   1        delay(500);
 103   1        return 2;
 104   1      }
*** WARNING C280 IN LINE 82 OF C51.c: 'a': unreferenced local variable
 105          unsigned int  A_D()     //ADC0832   ¶ÁÖµ³ÌĞò
 106          {
 107   1        unsigned char i;
 108   1        unsigned char dat;           
 109   1        ADC0832_CS=1;   //Ò»¸ö×ª»»ÖÜÆÚ¿ªÊ¼
 110   1        ADC0832_CLK=0;  //ÎªµÚÒ»¸öÂö³å×÷×¼±¸
 111   1        ADC0832_CS=0;  //CSÖÃ0£¬Æ¬Ñ¡ÓĞĞ§
 112   1        ADC0832_DIO=1;    //DIOÖÃ1£¬¹æ¶¨µÄÆğÊ¼ĞÅºÅ  
 113   1        ADC0832_CLK=1;   //µÚÒ»¸öÂö³å
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 3   

 114   1        ADC0832_CLK=0;   //µÚÒ»¸öÂö³åµÄÏÂ½µÑØ£¬´ËÇ°DIO±ØĞëÊÇ¸ßµçÆ½
 115   1        ADC0832_DIO=1;   //DIOÖÃ1£¬ Í¨µÀÑ¡ÔñĞÅºÅ  
 116   1        ADC0832_CLK=1;   //µÚ¶ş¸öÂö³å£¬µÚ2¡¢3¸öÂö³åÏÂ³ÁÖ®Ç°£¬DI±ØĞë¸ú±ğÊäÈëÁ½Î»Êı¾İÓÃÓÚÑ¡ÔñÍ¨µÀ£¬ÕâÀïÑ¡Í¨µÀRH0 
 117   1        ADC0832_CLK=0;   //µÚ¶ş¸öÂö³åÏÂ½µÑØ 
 118   1        ADC0832_DIO=0;   //DIÖÃ0£¬Ñ¡ÔñÍ¨µÀ0
 119   1        ADC0832_CLK=1;    //µÚÈı¸öÂö³å
 120   1        ADC0832_CLK=0;    //µÚÈı¸öÂö³åÏÂ½µÑØ 
 121   1        ADC0832_DIO=1;    //µÚÈı¸öÂö³åÏÂ³ÁÖ®ºó£¬ÊäÈë¶ËDIOÊ§È¥×÷ÓÃ£¬Ó¦ÖÃ1
 122   1        ADC0832_CLK=1;    //µÚËÄ¸öÂö³å
 123   1        for(i=0;i<8;i++)  //¸ßÎ»ÔÚÇ°
 124   1        {
 125   2          ADC0832_CLK=1;         //µÚËÄ¸öÂö³å
 126   2          ADC0832_CLK=0; 
 127   2          dat<<=1;       //½«ÏÂÃæ´¢´æµÄµÍÎ»Êı¾İÏòÓÒÒÆ
 128   2          dat|=(unsigned char)ADC0832_DIO;   //½«Êä³öÊı¾İDIOÍ¨¹ı»òÔËËã´¢´æÔÚdat×îµÍÎ» 
 129   2        }               
 130   1        ADC0832_CS=1;          //Æ¬Ñ¡ÎŞĞ§ 
 131   1        return dat;  //½«¶ÁÊéµÄÊı¾İ·µ»Ø     
 132   1      }
 133          
 134          
 135          /*
 136              1602Òº¾§£¬ÊÇ³£ÓÃµÄÏÔÊ¾Æ÷¼ş£¬Ò»¹²ÊÇ16¸ö¹Ü½Å£¬ÆäÖĞÓĞ°Ë¸ö¹Ü½ÅÊÇÊı¾İ´«Êä¹Ü½Å£¬ÓĞÈı¸ö¹Ü½ÅÊÇÊı¾İÃüÁîÊ¹ÄÜ¶Ë¹Ü
             -½Å£¬»¹ÓĞÁ½×éµçÔ´¹Ü½Å£¬
 137          ÆäÖĞÒ»×éµçÔ´¹Ü½ÅÊÇ¸øÕû¸öÒº¾§½øĞĞ¹©µçµÄ£¬»¹ÓĞÒ»×éµçÔ´ÊÇµ¥´¿µÄ±³¾°¹âµçÔ´£¬»¹Ê£ÏÂµÄ×îºóÒ»¸ö¹Ü½ÅÊÇ¶Ô±È¶Èµ÷½Ú¹Ü
             -½Å£¬Ò»°ã½ÓÉÏÒ»¸ö3Kµç
 138          ×èÔÙ½ÓµØ¼´¿É¡£
 139           
 140          */
 141          
 142          
 143          /********************************************************************
 144          * Ãû³Æ : LCD1602_write(uchar order,dat)
 145          * ¹¦ÄÜ : 1602Ğ´ÈçÊı¾İº¯Êı
 146          * ÊäÈë : ÊäÈëµÄÃüÁîÖµ
 147          * Êä³ö : ÎŞ
 148          ***********************************************************************/
 149          void LCD1602_write(uchar order,dat)         //1602 Ò»¸ö×Ö½Ú  ´¦Àí
 150          {
 151   1          LCD1602_e=0;//Ê¹ÄÜĞÅºÅ£¬1¶ÁÈ¡ĞÅÏ¢£¬ÏÂ½µÑØÖ´ĞĞÖ¸Áî£¬ÏÈĞĞÖÃÁã
 152   1          LCD1602_rs=order;//rs,0ÊäÈëÖ¸Áî£¬1ÊäÈëÊı¾İ
 153   1          LCD1602_dat=dat;//P0¿Ú
 154   1          LCD1602_rw=0;//read/write,0Ğ´1¶Á
 155   1          LCD1602_e=1;
 156   1          delay(1);
 157   1          LCD1602_e=0;                                                     
 158   1      }
 159          /********************************************************************
 160          * Ãû³Æ : LCD1602_writebye(uchar *prointer)
 161          * ¹¦ÄÜ : 1602Ğ´ÈëÊı¾İº¯Êı  Ö¸ÕëÊ½
 162          * ÊäÈë : ÊäÈëµÄÃüÁîÖµ
 163          * Êä³ö : ÎŞ
 164          ***********************************************************************/
 165          void LCD1602_writebyte(uchar *prointer)          //1602 ×Ö·û´®    ´¦Àí
 166          {
 167   1          while(*prointer!='\0')
 168   1          {
 169   2              LCD1602_write(1,*prointer);
 170   2              prointer++;
 171   2          }
 172   1      }
 173          /********************************************************************
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 4   

 174          * Ãû³Æ : LCD1602_cls()
 175          * ¹¦ÄÜ : ³õÊ¼»¯1602Òº¾§ 
 176          * ÊäÈë : ÎŞ
 177          * Êä³ö : ÎŞ
 178          ***********************************************************************/
 179          void LCD1602_cls()                   //1602 ³õÊ¼»¯
 180          {
 181   1        LCD1602_write(0,0x01);     //1602 ÇåÆÁ Ö¸Áî
 182   1        delay(1500);
 183   1        LCD1602_write(0,0x38);     // ¹¦ÄÜÉèÖÃ 8Î»¡¢5*7µãÕó001(Ö¸Áî±êÊ¶£¬±ØĞëÎª1)£¬1(Êı¾İ½Ó¿ÚÎ»Êı£¬1=8£¬=4)£¬ 1(µ
             -ãÕóÉèÖÃ)000£¬
 184   1        delay(1500);
 185   1        LCD1602_write(0,0x0c);     //Ô­0x0c,ÉèÖÃ ¹â±ê  00001100 ×îºóÈıÎ»±êÊ¶£¬ÓÒ4±ØĞë¶¨ÒåÎª1£¬²»ÏÔÊ¾¿ª¹Ø¡¢²»ÏÔÊ¾¹
             -â±ê¡¢×Ö·û²»ÉÁË¸
 186   1        LCD1602_write(0,0x06);    //Ô­x06,0000 0110 ½øÈëÄ£Ê½ÉèÖÃÖ¸Áî£¬ÓÒ2 Ğ´ÈëÊı¾İºó×óÒÆ/ÓÒÒÆ£¬ÓÒ1ÏÔÊ¾ÒÆ¶¯/²»ÏÔÊ¾
 187   1        LCD1602_write(0,0xd0);    
 188   1        delay(1500);
 189   1      }
 190          /********************************************************************
 191          * Ãû³Æ : show()
 192          * ¹¦ÄÜ : LCD1602Òº¾§ÏÔÊ¾³ÌĞò 
 193          * ÊäÈë : ÎŞ
 194          * Êä³ö : ÎŞ
 195          ***********************************************************************/
 196           
 197          /*
 198          Êı¾İÏÔÊ¾µÄÊ±ºòÒ»°ãµÄ´¦Àí£º
 199          
 200              Ê×ÏÈ£¬ÎŞÂÛÊÇÊıÂë¹ÜÏÔÊ¾»¹ÊÇÒº¾§ÏÔÊ¾£¬½øĞĞÏÔÊ¾µÄÊ±ºò¾ø¶Ô¶¼ÊÇÒ»¸öÒ»¸ö½øĞĞÏÔÊ¾µÄ£¬ÄÇÃ´£¬±ÈÈçËµÒ»¸öÊı¾İ123£
             -¬Ò»°Ù¶şÊ®Èı£¬
 201          ½øĞĞÏÔÊ¾µÄÊ±ºò£¬ÒªÏÈÏÔÊ¾1£¬È»ºóÊÇ2£¬È»ºóÊÇ3£¬ÄÇÃ´ÔõÃ´°ÑÊı¾İÌáÈ¡³öÀ´£¿£¿   
 202          ÌáÈ¡°ÙÎ»    123/100=1
 203          ÌáÈ¡Ê®Î»    123/10=12      12%10=2     ¡°%¡±ÊÇÈ¡ÓàµÄÒâË¼£¬ÏñÕâ¸ö£¬¾ÍÊÇ12¶Ô10È¡Óà£¬»»¾ä»°Ëµ£¬12³ıÒÔ10£¬È»ºó
             -È¡ÓàÊı£¬¾ÍÊÇ2
 204          ÌáÈ¡¸öÎ»    123%10=3       ½âÊÍÍ¬ÉÏ
 205          
 206          È¡ÓàµÄÓÃ·¨Ò²ÓĞºÜ¶àÖÖ£¬´ó¼ÒÖ»ÒªÖªµÀ³öÏÖÕâ¸öµÄÊ±ºò£¬Ò»°ã¶¼ÊÇ½øĞĞÊı¾İÌáÈ¡µÄ¾ÍĞĞ
 207          
 208          
 209          È»ºó
 210          Èç¹ûÄúÊÇÊıÂë¹ÜÏÔÊ¾Êı¾İ£¬½«ÌáÈ¡µÄÊı¾İ·Åµ½¶ÎÂëÊı×éÀïÃæËÍ¸øIO¼´¿É£¬
 211          Èç¹ûÊÇÒº¾§ÏÔÊ¾£¬ĞèÒª½«Êı¾İ×ª»¯³É×Ö·û£¬ÒòÎªÒº¾§ÊÇ×Ö·ûÆÁ£¬Ö»ÄÜÏÔÊ¾×Ö·ûÊı¾İ£¬Êı¾İ0¶ÔÓ¦µÄ×Ö·ûÊÇ0x30£¬Êı¾İ1¶ÔÓ¦
             -µÄ×Ö·ûÊÇ0x31£¬
 212          ËùÒÔ½«ÌáÈ¡³öµÄÊı¾İÖ±½Ó¼ÓÉÏ0x30ËÍ¸øÒº¾§¼´¿É£¬»òÕß¼ÓÉÏ'0' Ò²ÊÇÒ»ÑùµÄ 
 213          
 214          
 215           
 216          */
 217          
 218          
 219          void show()
 220          {
 221   1        if(state==0)    //µ±Ç°Ë®Î»¼°¹¤×÷Ä£Ê½ÏÔÊ¾,ÓÃË®¹ı¶ÈÏÔÊ¾
 222   1        {
 223   2          
 224   2          LCD1602_write(0,0x80);//ÉèÖÃDDRAMÏÔ´æµØÖ·Ö¸Áî£¬Ğ§¹ûÉÏÀàËÆÓÚÉèÖÃ¹â±ê£¬1+xxx,xxxx Ê×Î»±ØĞë1£¬Ê£ÏÂ¼¸Î»±êÊ¶µ
             -ØÖ·£¬×ó¶şÎª0Ê±£¬µÚÒ»ĞĞ£¬Îª1Ê±µÚ2ĞĞ//
 225   2          LCD1602_writebyte("WaterLevel:"); //µ±Ç°Ë®Î»
 226   2          LCD1602_write(0,0x80+11);
 227   2          if(RH>=10)LCD1602_write(1,0x30+((int)RH)/10);//dat»»rh
 228   2          else LCD1602_writebyte(" ");
 229   2          LCD1602_write(0,0x80+12);
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 5   

 230   2          LCD1602_write(1,0x30+((int)RH)%10);
 231   2          LCD1602_write(0,0x80+13);
 232   2          LCD1602_writebyte(".");
 233   2          LCD1602_write(1,0x30+((int)(RH*10))%10);
 234   2          //LCD1602_writebyte("cm");
 235   2      
 236   2          if(0)//overLimit == 1),ÉáÆúÁËÍ³¼Æ¹¦ÄÜ£¬²»Ğ´ÁË£¬´ıÉ¾
 237   2          {
 238   3            LCD1602_write(0,0xC0);  LCD1602_writebyte("WARN:Over Using");   //¹ı¶ÈÓÃË®
 239   3          }
 240   2          else
 241   2          {
 242   3            LCD1602_write(0,0xC0);  
 243   3            if(zt==0)
 244   3            {
 245   4              LCD1602_writebyte("State:Manul     ");
 246   4              
 247   4            }else if(zt==1)
 248   3            {
 249   4              LCD1602_writebyte("State:auto      ");
 250   4              if(RH>RH_H)    //Èç¹ûµ±Ç°Ë®Î»Öµ´ïµ½Ë®Î»ÉÏÏŞÖµÔò
 251   4              {
 252   5                 
 253   5                LCD1602_write(0,0xC0);  
 254   5                LCD1602_writebyte("Over Toplimit"); 
 255   5                
 256   5              }
 257   4              else  if(RH<=RH_L)     //Èç¹ûµ±Ç°Ë®Î»ÖµµÍÓÚË®Î»ÏÂÏŞÖµÔò
 258   4              { 
 259   5                LCD1602_writebyte("Over LowerLimit"); 
 260   5              }else     //·ñÔò 
 261   4              {
 262   5                LCD1602_writebyte("State:Auto     ");
 263   5              }
 264   4      
 265   4            }
 266   3            else if(zt == 3)
 267   3            {
 268   4              LCD1602_writebyte("State:PidNormal  ");
 269   4            }
 270   3            else if(zt == 2)
 271   3            {
 272   4              LCD1602_writebyte("State:PIDAuto   ");
 273   4            }
 274   3          }
 275   2            
 276   2        }else if(state == 1 || state == 2)    //Ë®Î»ÉÏÏÂÏŞÉèÖÃ½çÃæ£¬
 277   1        {
 278   2          LCD1602_write(0,0x80);
 279   2          LCD1602_writebyte("Water_H:");   //Ë®Î»ÉÏÏŞ£¬state == 1
 280   2          LCD1602_write(0,0x80+8);
 281   2          
 282   2          if(state==1&&s1==1)      //Í¨¹ıÉÁË¸±êÖ¾Îª  ´ïµ½ÉÁË¸µÄĞ§¹û,250ms¸ü¸ÄÒ»´Î
 283   2          {
 284   3            LCD1602_writebyte("  ");
 285   3          }else
 286   2          { LCD1602_write(0,0x80+8);
 287   3            if(RH_H>9)LCD1602_write(1,0x30+RH_H/10%10);
 288   3            else LCD1602_writebyte(" ");
 289   3            LCD1602_write(0,0x80+9);
 290   3            LCD1602_write(1,0x30+RH_H%10);    
 291   3          }
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 6   

 292   2          
 293   2          LCD1602_write(0,0x80+10);
 294   2          LCD1602_writebyte("cm    ");
 295   2      
 296   2          LCD1602_write(0,0xC0);
 297   2          LCD1602_writebyte("Water_L:");  //Ë®Î»ÏÂÏŞ
 298   2          if(state==2&&s1==1)    //Í¨¹ıÉÁË¸±êÖ¾Îª  ´ïµ½ÉÁË¸µÄĞ§¹û
 299   2          {
 300   3            LCD1602_write(0,0xC0+8);
 301   3            LCD1602_writebyte("  "); 
 302   3          }else
 303   2          {
 304   3            LCD1602_write(0,0xC0+8);
 305   3            if(RH_L>9)LCD1602_write(1,0x30+RH_L/10%10);
 306   3            else LCD1602_writebyte(" ");
 307   3            LCD1602_write(0,0xC0+9);
 308   3            LCD1602_write(1,0x30+RH_L%10);
 309   3          }
 310   2          LCD1602_write(0,0xC0+10);
 311   2          LCD1602_writebyte("cm    ");  
 312   2        }
 313   1        else if(state == 3)
 314   1        {
 315   2          LCD1602_write(0,0x80);//ÉèÖÃDDRAMÏÔ´æµØÖ·Ö¸Áî£¬Ğ§¹ûÉÏÀàËÆÓÚÉèÖÃ¹â±ê£¬1+xxx,xxxx Ê×Î»±ØĞë1£¬Ê£ÏÂ¼¸Î»±êÊ¶µ
             -ØÖ·£¬×ó¶şÎª0Ê±£¬µÚÒ»ĞĞ£¬Îª1Ê±µÚ2ĞĞ//
 316   2        /*  LCD1602_writebyte("Count:");  //µ±Ç°Ë®Î»
 317   2          LCD1602_write(0,0x80+6);
 318   2          LCD1602_write(1,0x30+waterCount/1000%10);
 319   2          LCD1602_write(0,0x80+7);
 320   2          LCD1602_write(1,0x30+waterCount/100%10);
 321   2          LCD1602_write(0,0x80+8);
 322   2          LCD1602_write(1,0x30+waterCount/10%10);
 323   2          LCD1602_write(0,0x80+9);
 324   2          LCD1602_write(1,0x30+waterCount%10);
 325   2          LCD1602_write(0,0x80+10);
 326   2          LCD1602_writebyte("Ton");
 327   2          LCD1602_write(0,0xC0);  
 328   2          LCD1602_writebyte("Press k2 reset");
 329   2          */
 330   2          LCD1602_write(0,0x80);
 331   2          LCD1602_write(1,0x30+((int)motorKP)/10);
 332   2          LCD1602_write(0,0x81);
 333   2          LCD1602_write(1,0x30+((int)motorKP)%10);
 334   2          LCD1602_writebyte(".");
 335   2          LCD1602_write(0,0x80+3);
 336   2          LCD1602_write(1,0x30+((int)(motorKP*10))%10);
 337   2          LCD1602_writebyte("  ");
 338   2          LCD1602_write(0,0x80+6);
 339   2          LCD1602_write(1,0x30+((uint)ki)/10);
 340   2          LCD1602_write(0,0x80+7);
 341   2          LCD1602_write(1,0x30+((uint)ki)%10);
 342   2          LCD1602_writebyte(".");
 343   2          LCD1602_write(0,0x80+9);
 344   2          LCD1602_write(1,0x30+((uint)(ki*10))%10);
 345   2          LCD1602_write(0,0x80+10);
 346   2          LCD1602_write(1,0x30+((uint)(ki*100))%10);
 347   2          LCD1602_writebyte("   "); 
 348   2          
 349   2          
 350   2          LCD1602_write(0,0xC0);
 351   2          LCD1602_writebyte("PID_KI:");  //Ë®Î»ÏÂÏŞ
 352   2          if(state==3&&s1==1)    //Í¨¹ıÉÁË¸±êÖ¾Îª  ´ïµ½ÉÁË¸µÄĞ§¹û
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 7   

 353   2          {
 354   3            LCD1602_write(0,0xC0+7);
 355   3            LCD1602_writebyte("       "); 
 356   3          }else
 357   2          {
 358   3            LCD1602_write(0,0xC0+7);
 359   3            LCD1602_writebyte(" ");
 360   3            LCD1602_write(0,0xC0+8);
 361   3            LCD1602_write(1,0x30+((uint)ki)%10);
 362   3            LCD1602_writebyte(".");
 363   3            LCD1602_write(0,0xC0+10);
 364   3            LCD1602_write(1,0x30+((uint)(ki*10))%10);
 365   3            LCD1602_write(0,0xC0+11);
 366   3            LCD1602_write(1,0x30+((uint)(ki*100))%10);
 367   3          }
 368   2          
 369   2      
 370   2          
 371   2        }
 372   1        else if(state == 4 || state == 5)   //µç»úËÙ¶ÈÉèÖÃ½çÃæ£¬
 373   1        {
 374   2          LCD1602_write(0,0x80);
 375   2          LCD1602_writebyte("Motor_K:");   //±ÈÀıÏµÊı£¬state == 1
 376   2          LCD1602_write(0,0x80+8);
 377   2          
 378   2          if(state==4&&s1==1)      //Í¨¹ıÉÁË¸±êÖ¾Îª  ´ïµ½ÉÁË¸µÄĞ§¹û,250ms¸ü¸ÄÒ»´Î
 379   2          {
 380   3            LCD1602_writebyte("        ");
 381   3          }else
 382   2          { 
 383   3            LCD1602_write(1,0x30+((int)motorKP)/10);
 384   3            LCD1602_write(0,0x80+9);
 385   3            LCD1602_write(1,0x30+((int)motorKP)%10);
 386   3            LCD1602_writebyte(".");
 387   3            LCD1602_write(0,0x80+11);
 388   3            LCD1602_write(1,0x30+((int)(motorKP*10))%10);
 389   3          }
 390   2          
 391   2      
 392   2          LCD1602_write(0,0xC0);
 393   2          LCD1602_writebyte("AimLevel:");  //ÓÃË®ÉÏÏŞ
 394   2          if(state==5&&s1==1)    //Í¨¹ıÉÁË¸±êÖ¾Îª  ´ïµ½ÉÁË¸µÄĞ§¹û
 395   2          {
 396   3            LCD1602_write(0,0xC0+9);
 397   3            LCD1602_writebyte("   "); 
 398   3          }else
 399   2          {
 400   3            LCD1602_write(0,0xC0+9);
 401   3            if(aimLevel>9)LCD1602_write(1,0x30+aimLevel/10%10);
 402   3            else LCD1602_writebyte(" ");
 403   3            LCD1602_write(0,0xC0+10);
 404   3            LCD1602_write(1,0x30+aimLevel%10);
 405   3          }
 406   2          LCD1602_write(0,0xC0+11);
 407   2          LCD1602_writebyte(" Ton");  
 408   2        }
 409   1      }
 410          /********************************************************************
 411          * Ãû³Æ : key()
 412          * ¹¦ÄÜ : °´¼ü¿ØÖÆ³ÌĞò     ÊµÏÖÏµÍ³¸÷¸ö¿ØÖÆ¹¦ÄÜ 
 413          * ÊäÈë : ÎŞ
 414          * Êä³ö : ÎŞ
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 8   

 415          ***********************************************************************/
 416          void key()
 417          {
 418   1        if(!key_1) //ÉèÖÃ°´¼ü  ÉèÖÃ  ¹¦ÄÜ£ºÇĞ»»ÏÔÊ¾¼°ÉèÖÃµÄÑ¡Ïî
 419   1        {
 420   2          delay(888);   //°´¼üÈ¥¶¶
 421   2          if(!key_1)  //ÔÙ´ÎÅĞ¶Ï°´¼ü
 422   2          {
 423   3            while(!key_1) show();  //°´¼üÅĞ¶ÏÊÇ·ñÊÍ·Å
 424   3            state=(state+1)%6;    //Ö´ĞĞ°´¼ü¹¦ÄÜ   ÇĞ»»ÉèÖÃÏî,²¢ÇÒÉèÖÃ¹éÁã
 425   3          }
 426   2        }
 427   1      
 428   1        if(!key_2)   //ÇĞ»»ÉèÖÃÏîÖµµÄ´óĞ¡    ¼°·ÇÉèÖÃÄ£Ê½ÏÂÇĞ»»ÏµÍ³¹¤×÷Ä£Ê½°´¼ü
 429   1        {
 430   2          delay(888);   //°´¼üÈ¥¶¶
 431   2          if(!key_2)   //ÔÙ´ÎÅĞ¶Ï°´¼ü
 432   2          {
 433   3            while(!key_2)show();  //°´¼üÅĞ¶ÏÊÇ·ñÊÍ·Å
 434   3            if(state==1)      //Ö´ĞĞ°´¼ü¹¦ÄÜ   ÇĞ»»ÉèÖÃÏî
 435   3            {
 436   4              if(RH_H<100)RH_H++;      //ÉèÖÃÉÏÏŞÖµ
 437   4              SectorErase(0x2000);   //±£´æÉÏÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 438   4              byte_write(0x2000,RH_H);
 439   4            }else if(state==2)
 440   3            {
 441   4              if(RH_L<RH_H-1)RH_L++;    //ÉèÖÃÏÂÏŞÖµ
 442   4              SectorErase(0x2200);   //±£´æÏÂÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 443   4              byte_write(0x2200,RH_L);
 444   4            }else if(state==3)
 445   3            {
 446   4              if(ki < 20)ki+=1;   //ÉèÖÃÉÏÏŞÖµ
 447   4              SectorErase(0x2400);   //±£´æµ½µ¥Æ¬»úÖĞEEPROM
 448   4              byte_write(0x2400,ki);
 449   4              
 450   4            }else if(state==4)
 451   3            {
 452   4              if(motorKP < 9)motorKP++;   //ÉèÖÃÉÏÏŞÖµ
 453   4              SectorErase(0x2600);   //±£´æµ½µ¥Æ¬»úÖĞEEPROM
 454   4              byte_write(0x2600,motorKP);
 455   4            }else if(state==5)
 456   3            {
 457   4              if(aimLevel < 99)aimLevel++;    //ÉèÖÃÉÏÏŞÖµ
 458   4              SectorErase(0x2800);   //  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 459   4              byte_write(0x2800,aimLevel);
 460   4            }
 461   3            else if(state == 0)
 462   3            {
 463   4      
 464   4              zt=(zt+1)%4;         //ÇĞ»»ÏµÍ³µÄ¹¤×÷Ä£Ê½   ×Ô¶¯   ÊÖ¶¯
 465   4              motorRunTime = 0;
 466   4              motorControl(0);
 467   4              
 468   4              //delay(500);
 469   4            } 
 470   3          }
 471   2        }
 472   1      
 473   1        if(!key_3)    //ÇĞ»»ÉèÖÃÏîÖµµÄ´óĞ¡    ¼°ÊÖ¶¯Ä£Ê½ÏÂÇĞ»»ÏµÍ³¹¤×÷×´Ì¬¡®¿ª¹Ø¡¯
 474   1        {
 475   2          delay(888); //°´¼üÈ¥¶¶
 476   2          if(!key_3)    //ÔÙ´ÎÅĞ¶Ï°´¼ü
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 9   

 477   2          {   
 478   3            while(!key_3)show();  //°´¼üÅĞ¶ÏÊÇ·ñÊÍ·Å
 479   3            if(state==1)      //Ö´ĞĞ°´¼ü¹¦ÄÜ   ÇĞ»»ÉèÖÃÏî
 480   3            {
 481   4              if(RH_H>RH_L+1)RH_H--;
 482   4              SectorErase(0x2000);   //±£´æÉÏÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 483   4              byte_write(0x2000,RH_H);
 484   4            }else if(state==2)
 485   3            {
 486   4              if(RH_L>0)RH_L--;
 487   4              SectorErase(0x2200);   //±£´æÏÂÏŞÖµ ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 488   4              byte_write(0x2200,RH_L);
 489   4            }else if(state==3)
 490   3            {
 491   4              if(ki>0)ki-=1;
 492   4              SectorErase(0x2400);   //±£´æÏÂÏŞÖµ ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 493   4              byte_write(0x2400,ki);
 494   4            }
 495   3            else if(state==4)
 496   3            {
 497   4              if(motorKP > 1)motorKP--;   //ÉèÖÃÏÂÏŞÖµ
 498   4              SectorErase(0x2600);   //±£´æÏÂÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 499   4              byte_write(0x2600,motorKP);
 500   4            }else if(state==5)
 501   3            {
 502   4              if(aimLevel > 1)aimLevel--;   //ÉèÖÃÏÂÏŞÖµ
 503   4              SectorErase(0x2800);   //±£´æÏÂÏŞÖµ  ±£´æµ½µ¥Æ¬»úÖĞEEPROM
 504   4              byte_write(0x2800,aimLevel);
 505   4            }
 506   3            else if(state==0)
 507   3            {
 508   4              if(zt==0)
 509   4              {
 510   5                motorControl(2);     //ÊÖ¶¯Ä£Ê½ÇĞ»»ÏµÍ³µÄ¹¤×÷×´Ì¬
 511   5                led_1 = !led_1;
 512   5                
 513   5              }else if(zt > 1)
 514   4              {
 515   5                  motorKP = byte_read(0x2600);
 516   5      
 517   5                  ki = byte_read(0x2400);
 518   5              }
 519   4              
 520   4            }
 521   3          }
 522   2        }   
 523   1      }
 524          /********************************************************************
 525          * Ãû³Æ : proc()
 526          * ¹¦ÄÜ : ÏµÍ³´¦Àí³ÌĞò²¿·Ö 
 527          * ÊäÈë : ÎŞ
 528          * Êä³ö : ÎŞ
 529          ***********************************************************************/
 530          void proc()
 531          {
 532   1      
 533   1          /////////´¦ÀíÂß¼­
 534   1          if(zt==1)   //zt==1  Îª×Ô¶¯Ä£Ê½    Èç¹ûÏµÍ³ÔÚ×Ô¶¯Ä£Ê½ÏÂ
 535   1          {
 536   2            pidFlag = 0;
 537   2            //motorControl(0);
 538   2            if(RH>=RH_H)  motorControl(0);   //¹Ø±Õ¼ÌµçÆ÷
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 10  

 539   2            if(RH>RH_H)    //Èç¹ûµ±Ç°Ë®Î»Öµ´ïµ½Ë®Î»ÉÏÏŞÖµÔò
 540   2            {
 541   3               
 542   3              led_1=0;    //ÏÔÊ¾¶ÔÓ¦µÄÖ¸Ê¾µÆ
 543   3              
 544   3            }else     //·ñÔò 
 545   2            {
 546   3              led_1=1;     //ÏÔÊ¾¶ÔÓ¦µÄÖ¸Ê¾µÆ
 547   3            }
 548   2      
 549   2            if(RH<=RH_L)     //Èç¹ûµ±Ç°Ë®Î»ÖµµÍÓÚË®Î»ÏÂÏŞÖµÔò
 550   2            {
 551   3              motorControl(1);   //¿ªÆô¼ÌµçÆ÷ 
 552   3              led_2=0;     //ÏÔÊ¾¶ÔÓ¦µÄÖ¸Ê¾µÆ
 553   3            }else     //·ñÔò 
 554   2            {
 555   3              led_2=1;     //--------------------------------------\ÏÔÊ¾¶ÔÓ¦µÄÖ¸Ê¾µÆ
 556   3            }
 557   2      
 558   2            if(RH>RH_H||RH<=RH_L)  //·äÃùÆ÷´¦Àí²¿·Ö   Èç¹ûµ±Ç°Ë®Î»³¬³öË®Î»ÉÏÏÂÏŞ  Ôò
 559   2            {
 560   3              beep1=1;       //¿ªÊ¼±¨¾¯ 
 561   3              }
 562   2            else     //·ñÔò
 563   2            {
 564   3              overLimit = 0;
 565   3              beep1=0;     //Í£Ö¹±¨¾¯
 566   3            }
 567   2          }else if(zt == 2)//pid¿ØÖÆÄ£Ê½
 568   1          {
 569   2            pidFlag = 1;
 570   2            led_1=led_2=1;
 571   2            beep1=0;
 572   2          }
 573   1          else if(zt == 0)
 574   1          {
 575   2            pidFlag = 0;
 576   2            //motorControl(0);
 577   2            beep1=0;     //ÊÖ¶¯Ä£Ê½¹Ø±ÕÖ¸Ê¾µÆ¼°·äÃùÆ÷
 578   2            led_1=led_2=1;
 579   2          }
 580   1          else if(zt == 3)
 581   1          {
 582   2            if(pidFlag == 0)
 583   2            {
 584   3              pidFlag = 1;
 585   3            }
 586   2          }
 587   1      }
 588          
 589          
 590          
 591          float getWaterLevel()//»ñÈ¡µ±Ç°ÂË²¨Ö®ºóµÄË®Î»£¬Í¬Ê±¸üĞÂÈ«¾Ö±äÁ¿RH
 592          {
 593   1        if(cs<20)  //ÅĞ¶ÏÊÇ·ñ¶ÁÈ¡20´ÎµÄÊı¾İÁË£¿  Èç¹ûÊÇÔò¿ªÊ¼¼ÆËãµ±Ç°Ë®Î»
 594   1          {
 595   2            cs++;      //Ã¿´Î¼¸´Î±êÖ¾Î»Ã¿¶ÁÈ¡Ò»´ÎÊı¾İ
 596   2            Ad_datN+=A_D();  //Á¬Ğø¶ÁÈ¡ÏµÍ³Êı¾İ20´Î£¨Ë®Î»ADÖµ£©µÄÊı¾İ
 597   2          }else
 598   1          {
 599   2             cs=0;       //¶Ô¼¸´Î±äÁ¿Çå0
 600   2             Ad_dat=Ad_dat*0.9+Ad_datN*0.1;  //×ÜÊı¾İµÄ£¬ÏµÍ³ÂË²¨ÔËËã    ²¢¼ÇÂ¼£¬ÔËËã¡¢ÂË²¨ºóµÄÏµÍ³Êı¾İ£¨Ë®Î»ADÊı¾
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 11  

             -İ£©£¬ÈÃºóÇå³ı×îĞ¡×ÜÊı¾İ±äÁ¿
 601   2             Ad_datN=0;   //Çå³ı
 602   2            // RH = Ad_dat/51-1.5;
 603   2            if(Ad_dat>80) 
 604   2              {
 605   3               RH=(Ad_dat-80.0)/48.0;  //¼ÆËãË®Î»
 606   3            } 
 607   2             
 608   2          }
 609   1          return RH;
 610   1      }
 611          
 612          
 613          float MOD(float a)
 614          {
 615   1        float b;
 616   1        if(a >= 0)
 617   1          return a;
 618   1        else
 619   1        {
 620   2          b = 0 - a ;
 621   2          return b;
 622   2        }
 623   1          
 624   1      }
 625          
 626          void pidControl()
 627          {
 628   1        static float e[2] = {0,0};//Îó²î
 629   1        static float u;//Ë®Á÷Á¿
 630   1        static uchar s = 1;//µç»ú¿ªÆôÊ±¼ä
 631   1        static int i = -1;
 632   1        static float ji = 0;//»ı·Öe
 633   1        static float kd = 0.3;//Î¢·ÖÏµÊı
 634   1        static float we = 0;//Î¢·Ö²î
 635   1        i = (i+1)%2;
 636   1        e[0] = e[1];  //ÉÏ´ÎµÄÎó²î
 637   1        e[1] = aimLevel - RH;
 638   1        ji += e[1];
 639   1        we = e[0] - e[1];
 640   1        
 641   1        if(zt == 2)
 642   1        {
 643   2          motorKP = 1 +  MOD(e[1])/2;
 644   2          if(we > 0)//Îó²îËõĞ¡ÁË
 645   2          {
 646   3            ki = motorKP * ki *1.2;
 647   3          }
 648   2          else
 649   2          {
 650   3            ki = motorKP * ki / 1.2;
 651   3          }
 652   2        }else if(zt == 3)
 653   1        {
 654   2          //motorKP = byte_read(0x2600);
 655   2          
 656   2          //ki = byte_read(0x2400);
 657   2        }
 658   1       
 659   1        
 660   1        u = e[i] * motorKP + ki * ji + kd * we; 
 661   1        if(u > 1)
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 12  

 662   1        {
 663   2          openMotorTime((int)(u));
 664   2        }
 665   1        else
 666   1        {
 667   2          //motorControl(0);
 668   2          motorRunTime = 0;
 669   2        }
 670   1      }
*** WARNING C280 IN LINE 630 OF C51.c: 's': unreferenced local variable
 671          
 672          
 673          void main()
 674          { 
 675   1      
 676   1        alarm_1 = 1;//¼ÌµçÆ÷×´Ì¬³õÊ¼»¯
 677   1        TMOD=0x01;    //¶¨Ê±Æ÷ÅäÖÃ³õÊ¼»¯
 678   1        TH0=0x3c;     //16Î»¶¨Ê±   ¶¨Ê±50ms
 679   1        TL0=0xb0;
 680   1        ET0=1;
 681   1        TR0=1;     //¿ªÆô×ÜÖĞ¶Ï    ¼°´ò¿ª¶¨Ê±Æ÷0
 682   1        EA=1;
 683   1        LCD1602_cls();     //LCD1602  ³õÊ¼»¯
 684   1        RH_H=byte_read(0x2000);    //¶ÁÈ¡EEPROMÖĞµÄË®Î»ÉÏÏÂÏŞµÄÖµ
 685   1        RH_L=byte_read(0x2200);
 686   1      
 687   1        
 688   1        ////////////////coffee//////////
 689   1      
 690   1        pidFlag = 0;
 691   1        pidTime = 2;//5sÒ»´ÎµÄ²ÉÑùÅĞ¶ÏÆµÂÊ
 692   1        /////////////
 693   1        motorKP = byte_read(0x2600);
 694   1        if((motorKP>10)||(motorKP<1))
 695   1        {
 696   2          motorKP=0;
 697   2        }
 698   1        ki = byte_read(0x2400);
 699   1        if((ki>9.9)||(ki<0.1))
 700   1        {
 701   2          ki=0.5;
 702   2        }
 703   1        waterCount = byte_read(0x2400);
 704   1        if((waterCount>99)||(waterCount<1))
 705   1        {
 706   2          waterCount=0;
 707   2        }
 708   1        motorKP = byte_read(0x2600);
 709   1        if((motorKP>9)||(motorKP<1))
 710   1        {
 711   2          motorKP=5;
 712   2        }
 713   1        aimLevel = byte_read(0x2800);
 714   1        if((aimLevel>99)||(aimLevel<1))
 715   1        {
 716   2          aimLevel=16;
 717   2        }
 718   1        overLimit = 0;
 719   1        
 720   1        //////////////////////////////
 721   1        if((RH_H>99)||(RH_L>99)||(RH_L>=RH_H))   {RH_H=14;  RH_L=7;} //Èç¹û³¬³öË®Î»ÉÏÏÂÏŞÉèÖÃµÄ·¶Î§£¬ÔòÖØĞÂ¸³Öµ
 722   1           
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 13  

 723   1        while(1)
 724   1        {
 725   2          /******************************************************
 726   2                ÁË Ë®Î»¼ÆËãÁËÂË²¨ÎÈ¶¨Êı¾İËã
 727   2          ******************************************************/
 728   2          
 729   2          getWaterLevel();
 730   2          show();   //µ÷ÓÃ×Ó³ÌĞò
 731   2          key();    //µ÷ÓÃ°´¼üÉ¨Ãè×Óº¯Êı
 732   2          proc();   //µ÷ÓÃ±¨¾¯×Óº¯Êı
 733   2        }
 734   1      }
 735          
 736          
 737          
 738          void UART_1() interrupt 1  //¶¨Ê±Æ÷0 ÖĞ¶Ï
 739          {
 740   1        TH0=0x3c;      //ÖØĞÂ¸³Öµ
 741   1        TL0=0xb0;
 742   1        ms++;       //50ms¼ÆÊı
 743   1        if(ms%5==0)   //250ms  ¼ÆÊ±
 744   1        {
 745   2            s1=!s1;     //¸Ä±äÉÁË¸±êÖ¾ÎªµÄÖµ
 746   2        }
 747   1        if(ms%10==0)     //500ms¶¨Ê±
 748   1        {
 749   2          if(beep1==1) //·äÃùÆ÷±¨¾¯´¦Àí   
 750   2          {
 751   3            beep=!beep;
 752   3          }else
 753   2          {
 754   3            beep=1;
 755   3          } 
 756   2          
 757   2          if(overLimit==1) //ÓÃË®¹ıÁ¿´¦Àí  ,Ë«µÆÉÁ 
 758   2          {
 759   3            led_1=!led_1;
 760   3            led_2=!led_2;
 761   3            
 762   3          }else
 763   2          {
 764   3            led_1 = led_2 = 1;
 765   3          }
 766   2        }
 767   1        if(ms>19)
 768   1        {
 769   2          if(pidFlag == 1 &&( zt == 2 || zt == 3))//ÈôÆô¶¯PID,Ã¿¸ôpidTimeÃëÆô¶¯Ò»´ÎpidÖ÷¿ØÖÆº¯Êı
 770   2          {
 771   3            if( pidCount == 0)
 772   3            {
 773   4              pidControl();
 774   4              pidCount = 0;
 775   4            }
 776   3            pidCount = (pidCount+1)% pidTime;
 777   3            
 778   3          }
 779   2          
 780   2          if(motorRunTime > 0 && motorControl(3) == 0)//¿ªÆôµç»úNÃë´úÂë¶Î£¬³éÏóÎªÖ»Òªµ÷ÓÃopenMotorTime()¾ÍÄÜÉèÖÃ
 781   2          {
 782   3            motorControl(1);
 783   3            motorRunTime--;
 784   3          }else if(motorRunTime > 0 && motorControl(3) == 1)
C51 COMPILER V9.57.0.0   C51                                                               04/11/2019 20:24:29 PAGE 14  

 785   2          {
 786   3            motorRunTime--;
 787   3          }
 788   2          else if(motorRunTime == 0 && motorControl(3) == 1)
 789   2          {
 790   3            motorControl(0);
 791   3            motorRunTime--;
 792   3          }
 793   2          
 794   2        /*  if(motorControl(3))//»ñÈ¡µç»ú×´Ì¬£¬µç»ú¿ªÆôÊ±
 795   2          {
 796   2            //motorTimeCount++;
 797   2            //motorTimeCount = motorTimeCount % (int)motorKP;
 798   2            //if(motorTimeCount == 0)
 799   2            //  waterCount++;
 800   2            //motorTimeCount = motorTimeCount % 256; //²»ĞèÒª»Ø0£¬ÒòÎªmotorTimeCountÉÏÏŞ¶¨µÄ¾ÍÊÇ256£¬ucharÀàĞÍ
 801   2          }*/
 802   2          ms=0;
 803   2        } 
 804   1      }
 805          
 806          
 807          
 808          
*** WARNING C294 IN LINE 238 OF C51.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3822    ----
   CONSTANT SIZE    =    228    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     63       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      4       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
